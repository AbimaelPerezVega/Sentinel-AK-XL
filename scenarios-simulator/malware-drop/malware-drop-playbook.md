ğŸ¦  Malware Drop Simulation Playbook

ğŸš¨ Purpose: This simulation validates Wazuhâ€™s File Integrity Monitoring (FIM) and ensures VirusTotal integration flags malicious files.
ğŸ“š It also trains SOC analysts on malware alert investigation and escalation workflows.

ğŸ¯ Objectives

âœ… Validate Wazuh FIM file monitoring.

âœ… Confirm VirusTotal detects malicious EICAR test files.

âœ… Provide analysts with hands-on training for malware detection workflows.

âš™ï¸ Step-by-Step Execution
ğŸ“ Prerequisites

 Wazuh Manager container is running

 docker compose installed

 Access to /var/ossec/data/fimtest/ directory

ğŸ”½ Step 1. Copy the script into the Wazuh Manager container
docker cp ./malware-drop-simulator.sh wazuh.manager:/tmp/

âš¡ Step 2. Make the script executable and run it
docker compose exec wazuh.manager bash -lc "chmod +x /tmp/malware-drop-simulator.sh && /tmp/malware-drop-simulator.sh 10 3"

Argument	Description
10	Total number of files created
3	Every 3rd file is malicious (EICAR test file)
ğŸ“¡ Step 3. Monitor simulation logs
docker compose exec wazuh.manager tail -f /var/log/malware-drop-simulation.log


ğŸ’¡ Tip: Use Ctrl + C to stop log monitoring when finished.

ğŸ§¹ Step 4. Clean up test files
docker compose exec wazuh.manager rm -f /var/ossec/data/fimtest/*

ğŸ“Š Expected Results
Component	Expected Behavior
Wazuh	FIM alerts generated for each new file
VirusTotal	Flags EICAR test files as malicious
SOC Dashboard	Alerts appear under Threat Intelligence & FIM views
ğŸ›¡ï¸ SOC Response Workflow

ğŸ” Review alerts in the Wazuh dashboard.

ğŸ§¾ Validate file hashes against VirusTotal results.

ğŸš© Escalate incidents if multiple malicious files appear in a short timeframe.

ğŸ“ Document findings including:

Alert ID

File path

Detection timestamp

Analyst response

âœ¨ End Result: Analysts gain confidence in malware detection, VirusTotal correlation, and SOC alert escalation workflows.