🦠 Malware Drop Simulation Playbook

🚨 Purpose: This simulation validates Wazuh’s File Integrity Monitoring (FIM) and ensures VirusTotal integration flags malicious files.
📚 It also trains SOC analysts on malware alert investigation and escalation workflows.

🎯 Objectives

✅ Validate Wazuh FIM file monitoring.

✅ Confirm VirusTotal detects malicious EICAR test files.

✅ Provide analysts with hands-on training for malware detection workflows.

⚙️ Step-by-Step Execution
📝 Prerequisites

 Wazuh Manager container is running

 docker compose installed

 Access to /var/ossec/data/fimtest/ directory

🔽 Step 1. Copy the script into the Wazuh Manager container
docker cp ./malware-drop-simulator.sh wazuh.manager:/tmp/

⚡ Step 2. Make the script executable and run it
docker compose exec wazuh.manager bash -lc "chmod +x /tmp/malware-drop-simulator.sh && /tmp/malware-drop-simulator.sh 10 3"

Argument	Description
10	Total number of files created
3	Every 3rd file is malicious (EICAR test file)
📡 Step 3. Monitor simulation logs
docker compose exec wazuh.manager tail -f /var/log/malware-drop-simulation.log


💡 Tip: Use Ctrl + C to stop log monitoring when finished.

🧹 Step 4. Clean up test files
docker compose exec wazuh.manager rm -f /var/ossec/data/fimtest/*

📊 Expected Results
Component	Expected Behavior
Wazuh	FIM alerts generated for each new file
VirusTotal	Flags EICAR test files as malicious
SOC Dashboard	Alerts appear under Threat Intelligence & FIM views
🛡️ SOC Response Workflow

🔍 Review alerts in the Wazuh dashboard.

🧾 Validate file hashes against VirusTotal results.

🚩 Escalate incidents if multiple malicious files appear in a short timeframe.

📝 Document findings including:

Alert ID

File path

Detection timestamp

Analyst response

✨ End Result: Analysts gain confidence in malware detection, VirusTotal correlation, and SOC alert escalation workflows.