📘 Malware Drop Simulation Playbook
🎯 Objective

Validate Wazuh File Integrity Monitoring (FIM).

Confirm VirusTotal detects malicious (EICAR) files.

Train SOC analysts in malware detection workflows.

⚙️ Step-by-Step Execution

Step 1. Copy the script into the Wazuh Manager container

docker cp .\malware-drop-simulator.sh wazuh.manager:/tmp/


Step 2. Make the script executable and run it

docker compose exec wazuh.manager bash -lc "chmod +x /tmp/malware-drop-simulator.sh && /tmp/malware-drop-simulator.sh 10 3"


10 → total number of files created

3 → every 3rd file will be malicious

Step 3. Monitor simulation logs

tail -f /var/log/malware-drop-simulation.log


Step 4. Clean up test files

rm -f /var/ossec/data/fimtest/*

📊 Expected Results

Wazuh generates FIM alerts for new files.

VirusTotal flags EICAR files as malicious.

SOC dashboard shows clear alert correlation.

🛡️ SOC Response Workflow

Review alerts in Wazuh dashboard.

Validate hashes with VirusTotal results.

Escalate if multiple files appear in a short window.

Document alert ID, file path, detection time.