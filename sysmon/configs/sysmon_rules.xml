<group name="sysmon,windows,attack,">
  
  <rule id="100100" level="3">
    <field name="win.system.providerName">^Microsoft-Windows-Sysmon$</field>
    <description>Grouping for Sysmon Events.</description>
    <group>sysmon_event,</group>
  </rule>

  <rule id="100101" level="5">
    <if_sid>100100</if_sid>
    <field name="win.system.eventID">^1$</field>
    <description>Sysmon - Process Created: $(win.eventdata.image)</description>
    <group>sysmon_process_creation,</group>
  </rule>
  
  <rule id="100110" level="8">
    <if_sid>100101</if_sid>
    <regex>powershell\.exe|wscript\.exe|cscript\.exe|regsvr32\.exe|rundll32\.exe|mshta\.exe|suspicious_malware\.exe|cryptolocker\.exe|backdoor\.exe</regex>
    <description>Sysmon - Suspicious process execution detected: $(win.eventdata.image)</description>
    <group>sysmon_suspicious_process,attack_execution,</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>

  <rule id="100111" level="9">
    <if_sid>100101</if_sid>
    <regex>\.downloadString|\(New-Object Net\.WebClient\)|-ExecutionPolicy Bypass|-enc\s</regex>
    <description>Sysmon - Suspicious command line detected: $(win.eventdata.commandLine)</description>
    <group>sysmon_suspicious_cmdline,attack_execution,</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  
  <rule id="100103" level="5">
    <if_sid>100100</if_sid>
    <field name="win.system.eventID">^3$</field>
    <description>Sysmon - Network Connection: $(win.eventdata.image) to $(win.eventdata.destinationIp)</description>
    <group>sysmon_network_connection,</group>
  </rule>
  
  <rule id="100120" level="8">
    <if_sid>100103</if_sid>
    <field name="win.eventdata.destinationPort">^4444$|^5555$|^6666$|^1337$</field>
    <description>Sysmon - Connection to suspicious backdoor port: $(win.eventdata.destinationPort)</description>
    <group>sysmon_suspicious_network,attack_command_control,</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>

</group>
